Современный конвейер распознавания лиц состоит из 4 общих этапов: обнаружение, выравнивание, нормализация, представление и проверка. 
Эксперименты показывают, что выравнивание повышает точность распознавания лиц почти на 1%. 


1. Распознавание лица: **любая one-stage object detection model: YOLO, RetinaNet, SSD etc**. 
+ использование feature pyramid, а не sliding window (очень важно находить лица, в какой бы близости к камере они ни находились)
+ мультизадачность (За один проход сетка возвращает не только решение о том, присутствует ли лицо на изображении, но и координаты, 
где оно находится, а также основные лицевые точки)
![пайплайн детектирования лиц](https://habrastorage.org/getpro/habr/upload_files/dc2/9e1/2e1/dc29e12e1d2108f0c9e9ae490ceb039d.png)
  
2. Нормализатор (найденное лицо вырезается по координатам детектора из исходного изображения и выравнивается): **Umeyama**
найти ключевые точки лица (центры глаз, кончик носа) и вычислить такую матрицу, в результате применения которой 
кончик носа окажется по центру изображения, а глаза выровняются на одном горизонтальном уровне. 

3. извлечение дескрипторов (математический вектор заданного размера, который описывает положение точки в пространстве признаков)
Подготовленное изображение отправляется в нейронную сеть для извлечения дескрипторов: **ResNet**
+ блочная структура 
+ наличие skip-connections
+ можно легко модернизировать на любом этапе обучения без сильных потерь в качестве
***Задача по извлечению дескрипторов metric learning***

### НЕЙРОНКИ:
**МЕТРИКИ**: 

!pip install torchmetrics
import torchmetrics
from torchmetrics.detection.mean_ap import MeanAveragePrecision
from pprint import pprint
target = [dict(boxes=torch.tensor([[214.0, 41.0, 562.0, 285.0]]), labels=torch.tensor([0]))]
metric = MeanAveragePrecision()
metric.update(prediction, target)
pprint(metric.compute())
